<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="qna">

 <select id="totalCount" parameterType="faqVO" resultType="int">
    SELECT COUNT(*)  totalCount FROM faq_admin 
    <if test="u_id !=null">
    	where u_id=#{u_id}
    </if>
    </select>
    


<select id="allFaqp" parameterType="faqVO" resultType="faqVO">
SELECT q_no, q_state, q_title, q_content,  TO_CHAR(q_date, 'YYYY.MM.DD') as q_date, u_id
	 FROM faq_admin WHERE q_no in(SELECT q_no FROM (SELECT rownum as rnum, q_no FROM
	 (SELECT q_no FROM faq_admin nnb 
	 <if test="u_id !=null">
    	where u_id=#{u_id}
    </if>
	 ORDER BY q_date DESC))
	 WHERE rnum BETWEEN  #{startRowNo} AND #{endRowNo})ORDER BY q_date DESC
</select>
<!-- 메인에 띄워줄 QnA 리스트 -->
<select id="mainQna" parameterType="qnaVO" resultType="qnaVO"> 
<![CDATA[
select rownum rs, b_no, in_title, in_point
from(
select * from qna_board order by b_no desc)
where rownum<4
]]>
</select>

<!-- 리스트 -->
<select id="allQna" resultType="qnaVO">
SELECT b_no, in_title, in_nick, in_count, TO_CHAR(in_date, 'YYYY.MM.DD') as in_date ,NVL(in_good,0) in_good, in_photo1name ,in_photo2name, in_photo3name
	FROM qna_board  order by b_no desc
</select>


<!-- FAQ리스트 -->
<select id="allFaq" resultType="faqVO">
SELECT q_no, q_state, q_title, q_content,  TO_CHAR(q_date, 'YYYY.MM.DD') as q_date, u_id  FROM faq_admin
<where>
<if test="q_no neq null">
q_no = #{q_no}
</if>
</where>

</select>
<!-- 1:1문의 -->
<insert id="writeFaq" parameterType="faqVO">
INSERT INTO faq_admin (q_no, q_date, q_title, q_content, u_id)VALUES (mom_qna_no.nextval, sysdate, #{q_title}, #{q_content}, #{u_id})
</insert>


</mapper>