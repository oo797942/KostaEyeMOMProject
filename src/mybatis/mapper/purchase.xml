<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="purchase">

<!-- 메인에 띄워줄 공동구매 리스트 -->
<select id="mainpurchase" parameterType="purchaseVO" resultType="purchaseVO"> 
<![CDATA[
select rownum rs, b_no, we_title, we_photo1name, we_price, we_sold, we_maxsold, we_start, we_end from(
select b_no, we_title, we_photo1name, we_price, we_sold, we_maxsold, 
TO_CHAR(we_start, 'YYYY"년" MM"월" DD"일"') we_start, TO_CHAR(we_end, 'YYYY"년" MM"월" DD"일"') we_end from group_purchase order by b_no desc)
where rownum <5
]]>
</select>

<select id="totalCount"  resultType="int">
    SELECT COUNT(*)  totalCount FROM group_purchase
</select>

<select id="allBoardp"  resultType="purchaseVO">
	SELECT b_no, we_title, we_price , we_maxsold, we_sold, TO_CHAR(we_end, 'MM/DD') as we_end , we_photo1name
	 FROM group_purchase WHERE b_no in(SELECT b_no FROM (SELECT rownum as rnum, b_no FROM
	 (SELECT b_no FROM group_purchase nnb ORDER BY b_no DESC))
	 WHERE rnum BETWEEN #{startRowNo} AND  #{endRowNo})ORDER BY b_no DESC
</select>

<select id="getItem" parameterType="purchaseVO" resultType="purchaseVO" >
SELECT b_no, we_title, we_content, we_price , we_maxsold, we_sold, TO_CHAR(we_start, 'YYYY"년" MM"월" DD"일"') we_start, TO_CHAR(we_end, 'YYYY"년" MM"월" DD"일"') as we_end , we_photo1name, we_photo2name, we_photo3name
FROM  group_purchase WHERE b_no=#{b_no}
</select>

</mapper>